<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Agenda de Horários - Moinhos de Vento</title>
  <link rel="stylesheet" href="style.css">
  <style>
    /* Estilos simples do dashboard */
    .dash-toolbar { display:flex; gap:10px; align-items:center; margin-bottom:12px; }
    .dash-table { width:100%; border-collapse: collapse; }
    .dash-table th, .dash-table td { border:1px solid var(--cinza-borda); padding:8px; font-size:14px; }
    .dash-table th { background:#f3f6f8; text-align:left; }
    .dash-grid { display:grid; grid-template-columns: 1fr; gap:20px; }
    @media (min-width: 900px){ .dash-grid{ grid-template-columns: 1fr 1fr; } }
    .number { text-align:right; white-space:nowrap; }
    .pill { display:inline-block; padding:2px 8px; border-radius:999px; background:#eef6ff; color:#0b5ed7; font-size:12px; }
  </style>
</head>
<body>
  <div class="personagem-container"><div class="personagens-loop"></div></div>

  <header>
    <div class="logos-container">
      <img src="https://www.hospitalmoinhos.org.br/assets/images/logo-w-hopkins.png" alt="Logo Hospital Moinhos de Vento" id="logo-hmv">
      <img src="img/casa-colaborador.png" alt="Logo Casa do Colaborador" id="logo-casa-colaborador">
    </div>
    <h1>Agenda de Horários para Colaboradores</h1>

    <!-- Botão Admin fixo -->
    <button id="btn-admin-login" class="btn-acao btn-cinza">Login Admin</button>

    <p class="observacao">
      Em caso de dúvidas entre em contato com
      <a href="mailto:casa.colaborador@hmv.org.br">casa.colaborador@hmv.org.br</a>
    </p>
  </header>

  <div id="seletor-container" role="region" aria-label="Seleção de data e ações">
    <label for="seletor-data">Selecione uma data:</label>
    <input type="date" id="seletor-data" aria-describedby="dia-semana">
    <span id="dia-semana" class="dia-semana-label"></span>

    <button id="btn-consultar-reservas" class="btn-acao btn-azul" type="button">Minhas Reservas</button>
    <button id="btn-gerenciar-agenda" class="btn-acao btn-vermelho hidden" type="button">Gerenciar Agenda</button>
  </div>

  <!-- Menu de atividades (chips) -->
  <div id="menu-atividades" style="max-width:1200px;margin:0 auto 10px auto;"></div>

  <div id="agenda-container" class="agenda-grid">
    <p class="loading">Carregando agenda...</p>
  </div>

  <!-- Modal Reserva -->
  <div id="modal-agendamento" class="modal-overlay hidden" aria-hidden="true">
    <div class="modal-content" role="dialog" aria-modal="true" aria-labelledby="titulo-modal-agendamento">
      <h2 id="titulo-modal-agendamento">Confirmar Agendamento</h2>
      <ul id="modal-detalhes" class="detalhes-agendamento-lista"></ul>

      <div class="form-group">
        <label for="input-matricula">Sua Matrícula (Ex: 12345):</label>
        <input type="text" id="input-matricula" placeholder="Digite sua matrícula" required>
      </div>

      <!-- E-mail opcional (confirmação de reserva) -->
      <div class="form-group">
        <label for="input-email">E-mail (opcional para confirmação):</label>
        <input type="email" id="input-email" placeholder="ex: nome@hmv.org.br">
      </div>

      <div id="modal-mensagem" aria-live="polite"></div>
      <div class="modal-botoes">
        <button id="btn-cancelar-agendamento" class="btn-modal btn-cinza" type="button">Cancelar</button>
        <button id="btn-confirmar" class="btn-modal btn-verde" type="button">Confirmar Reserva</button>
      </div>
    </div>
  </div>

  <!-- Modal Consulta Reservas -->
  <div id="modal-consulta" class="modal-overlay hidden" aria-hidden="true">
    <div class="modal-content" role="dialog" aria-modal="true" aria-labelledby="titulo-modal-consulta">
      <div id="consulta-view-inicial">
        <h2 id="titulo-modal-consulta">Minhas Reservas</h2>
        <p>Digite sua matrícula para ver ou cancelar seus agendamentos futuros.</p>

        <div class="form-group">
          <label for="input-consulta-matricula">Sua Matrícula:</label>
          <input type="text" id="input-consulta-matricula" placeholder="Digite sua matrícula">
        </div>

        <!-- E-mail opcional (confirmação de cancelamento) -->
        <div class="form-group">
          <label for="input-consulta-email">E-mail (opcional para notificações de cancelamento):</label>
          <input type="email" id="input-consulta-email" placeholder="ex: nome@hmv.org.br">
        </div>

        <div class="modal-botoes">
          <button id="btn-fechar-consulta" class="btn-modal btn-cinza" type="button">Fechar</button>
          <button id="btn-buscar-reservas" class="btn-modal btn-azul" type="button">Buscar</button>
        </div>
      </div>

      <div id="consulta-view-resultados" class="hidden">
        <h2>Seus Agendamentos</h2>
        <div id="lista-agendamentos"></div>
        <div class="modal-botoes">
          <button id="btn-voltar-consulta" class="btn-modal btn-cinza" type="button">Voltar</button>
        </div>
      </div>

      <div id="consulta-mensagem" aria-live="polite"></div>
    </div>
  </div>

  <!-- Modal Admin Login -->
  <div id="modal-admin-login" class="modal-overlay hidden" aria-hidden="true">
    <div class="modal-content" role="dialog" aria-modal="true" aria-labelledby="titulo-modal-admin-login">
      <h2 id="titulo-modal-admin-login">Acesso Administrativo</h2>
      <div class="form-group">
        <label for="input-admin-password">Senha Admin:</label>
        <input type="password" id="input-admin-password" placeholder="Digite a senha">
      </div>
      <div id="admin-login-mensagem" aria-live="polite"></div>
      <div class="modal-botoes">
        <button id="btn-cancelar-admin-login" class="btn-modal btn-cinza" type="button">Cancelar</button>
        <button id="btn-confirmar-admin-login" class="btn-modal btn-vermelho" type="button">Entrar</button>
      </div>
    </div>
  </div>

  <!-- Modal Admin Gerenciar -->
  <div id="modal-admin-gerenciar" class="modal-overlay hidden" aria-hidden="true">
    <div class="modal-content" role="dialog" aria-modal="true" aria-labelledby="titulo-modal-admin-gerenciar">
      <h2 id="titulo-modal-admin-gerenciar">Painel de Administração</h2>
      <p>Selecione a ação desejada.</p>
      <div class="modal-botoes vertical-botoes">
        <button id="btn-admin-adicionar" class="btn-modal btn-verde" type="button">Adicionar Novos Horários</button>
        <button id="btn-admin-dashboard" class="btn-modal btn-azul" type="button">Painel / Dashboard</button>
        <button id="btn-admin-logout" class="btn-modal btn-cinza" type="button">Logout Admin</button>
        <button id="btn-fechar-admin-gerenciar" class="btn-modal btn-cinza" type="button">Fechar</button>
      </div>
    </div>
  </div>

  <!-- Modal Admin Adicionar -->
  <div id="modal-admin-adicionar" class="modal-overlay hidden" aria-hidden="true">
    <div class="modal-content large-modal" role="dialog" aria-modal="true" aria-labelledby="titulo-modal-admin-adicionar">
      <h2 id="titulo-modal-admin-adicionar">Adicionar Novo Horário à Agenda</h2>
      <div id="admin-add-mensagem" aria-live="polite"></div>
      <form id="form-adicionar-horario">
        <div class="form-row">
          <div class="form-group flex-item">
            <label for="admin-select-data">Data:</label>
            <input type="date" id="admin-select-data" required>
          </div>

          <div class="form-group flex-item">
            <label for="admin-select-profissional">Profissional:</label>
            <select id="admin-select-profissional" required>
              <option value="" disabled selected>Selecione o Profissional</option>
              <option value="Ana">Ana (Aulas)</option>
              <option value="Carlos">Carlos (Aulas)</option>
              <option value="Luis">Luis (Quick Massage)</option>
              <option value="Maria Eduarda">Maria Eduarda (Quick Massage)</option>
              <option value="Rafael">Rafael (Quick / Reiki)</option>
            </select>
          </div>
        </div>

        <div class="form-group">
          <label for="admin-select-atividade">Modalidade:</label>
          <select id="admin-select-atividade" required disabled>
            <option value="" disabled selected>Selecione o Profissional primeiro</option>
          </select>
        </div>

        <div id="quick-massage-container" class="hidden">
          <p class="alerta-admin">Selecione os horários disponíveis (1 vaga padrão):</p>
          <div id="quick-massage-horarios" class="horarios-grid"></div>
        </div>

        <div id="horario-unico-container" class="hidden">
          <div class="form-row">
            <div class="form-group flex-item">
              <label for="admin-input-horario">Horário de Início (HH:MM):</label>
              <input type="text" id="admin-input-horario" pattern="[0-9]{2}:[0-9]{2}" placeholder="Ex: 08:30">
            </div>
            <div id="vagas-container-unico" class="form-group flex-item">
              <label for="admin-input-vagas">Vagas Totais:</label>
              <input type="number" id="admin-input-vagas" min="1" value="1">
            </div>
          </div>
        </div>

        <div class="modal-botoes">
          <button id="btn-cancelar-adicionar-final" class="btn-modal btn-cinza" type="button">Cancelar</button>
          <button id="btn-confirmar-adicionar-final" class="btn-modal btn-azul" type="submit" disabled>Adicionar à Agenda</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Modal Dashboard -->
  <div id="modal-admin-dashboard" class="modal-overlay hidden" aria-hidden="true">
    <div class="modal-content" style="max-width:1000px" role="dialog" aria-modal="true" aria-labelledby="titulo-modal-dashboard">
      <h2 id="titulo-modal-dashboard">Dashboard — Resumo do Dia</h2>

      <div class="dash-toolbar">
        <label for="dash-select-date">Data:</label>
        <input type="date" id="dash-select-date">
        <span id="dash-info" class="pill">—</span>
        <div style="flex:1"></div>
        <button id="btn-dash-close" class="btn-modal btn-cinza" type="button">Fechar</button>
      </div>

      <div class="dash-grid">
        <div>
          <h3>Por Atividade</h3>
          <div id="dash-activity-table"></div>
        </div>
        <div>
          <h3>Por Profissional</h3>
          <div id="dash-prof-table"></div>
        </div>
      </div>

      <div style="margin-top:18px">
        <h3>Detalhe por Atividade × Profissional</h3>
        <div id="dash-ap-table"></div>
      </div>
    </div>
  </div>

  <div class="qr-code-container">
    <img src="img/qr-code-aulas.png" alt="Código QR para Aulas" id="qr-code-aulas">
  </div>

  <!-- atualize a versão se fizer novo deploy para forçar o refresh do navegador -->
  <script src="script.js?v=20251022-accordion-email"></script>
</body>
</html>

